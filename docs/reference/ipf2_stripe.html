<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The ipf2.b function finds the maximum likelihood estimates for fitted values in the log-linear model:
$$ \log y_{pq} = \log \alpha_{p} + \log \beta_{q} + \log \lambda_{ij}I(p \in i, q \in j) + \log m_{pq} $$
where \(m_{pq}\) is a prior estimate for \(y_{pq}\) and is no more complex than the matrices being fitted. The \(\lambda_{ij}I(p \in i, q \in j)\) term ensures a saturated fit on the block the \((i,j)\) block."><title>iterative proportional fitting routine for the indirect estimation of origin-destination-type migration flow tables with known origin and destination margins and stripe elements. — ipf2_stripe • migest</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="iterative proportional fitting routine for the indirect estimation of origin-destination-type migration flow tables with known origin and destination margins and stripe elements. — ipf2_stripe"><meta property="og:description" content="The ipf2.b function finds the maximum likelihood estimates for fitted values in the log-linear model:
$$ \log y_{pq} = \log \alpha_{p} + \log \beta_{q} + \log \lambda_{ij}I(p \in i, q \in j) + \log m_{pq} $$
where \(m_{pq}\) is a prior estimate for \(y_{pq}\) and is no more complex than the matrices being fitted. The \(\lambda_{ij}I(p \in i, q \in j)\) term ensures a saturated fit on the block the \((i,j)\) block."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2XE3QBSNZJ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2XE3QBSNZJ');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">migest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/guyabel/migest/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/guyabelguyabel">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://guyabel.com">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>iterative proportional fitting routine for the indirect estimation of origin-destination-type migration flow tables with known origin and destination margins and stripe elements.</h1>
      <small class="dont-index">Source: <a href="https://github.com/guyabel/migest/blob/HEAD/R/ipf2_stripe.R" class="external-link"><code>R/ipf2_stripe.R</code></a></small>
      <div class="d-none name"><code>ipf2_stripe.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>ipf2.b</code> function finds the maximum likelihood estimates for fitted values in the log-linear model:
$$ \log y_{pq} = \log \alpha_{p} + \log \beta_{q} + \log \lambda_{ij}I(p \in i, q \in j) + \log m_{pq} $$
where \(m_{pq}\) is a prior estimate for \(y_{pq}\) and is no more complex than the matrices being fitted. The \(\lambda_{ij}I(p \in i, q \in j)\) term ensures a saturated fit on the block the \((i,j)\) block.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ipf2_stripe</span><span class="op">(</span></span>
<span>  row_tot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col_tot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stripe_tot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stripe <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  m <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>row_tot</dt>
<dd><p>Vector of origin totals to constrain the sum of the imputed cell rows.</p></dd>


<dt>col_tot</dt>
<dd><p>Vector of destination totals to constrain the sum of the imputed cell columns.</p></dd>


<dt>stripe_tot</dt>
<dd><p>Matrix of stripe totals to constrain the sum of the imputed cell blocks.</p></dd>


<dt>stripe</dt>
<dd><p>Matrix of stripe structure corresponding to <code>stripe_tot</code>.</p></dd>


<dt>m</dt>
<dd><p>Matrix of auxiliary data. By default set to 1 for all origin-destination combinations.</p></dd>


<dt>tol</dt>
<dd><p>Numeric value for the tolerance level used in the parameter estimation.</p></dd>


<dt>maxit</dt>
<dd><p>Numeric value for the maximum number of iterations used in the parameter estimation.</p></dd>


<dt>verbose</dt>
<dd><p>Logical value to indicate the print the parameter estimates at each iteration. By default <code>FALSE</code>.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passes to <code><a href="stripe_matrix.html">stripe_matrix</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Iterative Proportional Fitting routine set up using the partial likelihood derivatives. The arguments <code>row_tot</code> and <code>col_tot</code> take the row-table and column-table specific known margins. The <code>stripe_tot</code> take the totals over the stripes in the matrix defined with <code>b</code>. Diagonal values can be added by the user, but care must be taken to ensure resulting diagonals are feasible given the set of margins. 
The user must ensure that the row and column totals in each table sum to the same value. Care must also be taken to allow the dimension of the auxiliary matrix (<code>m</code>) equal those provided in the row and column totals.
Returns a <code>list</code> object with</p>
<dl><dt>mu </dt>
<dd><p>Array of indirect estimates of origin-destination matrices by migrant characteristic</p></dd>

<dt>it </dt>
<dd><p>Iteration count</p></dd>

<dt>tol </dt>
<dd><p>Tolerance level at final iteration</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="stripe_matrix.html">stripe_matrix</a></code>, <code><a href="block_matrix.html">block_matrix</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Guy J. Abel</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">ipf2_stripe</span><span class="op">(</span>row_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">85</span>, <span class="fl">70</span>, <span class="fl">35</span>, <span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">55</span>, <span class="fl">65</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> stripe_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">20</span>,<span class="fl">50</span>,</span></span>
<span class="r-in"><span>                <span class="fl">35</span>,<span class="fl">10</span>,<span class="fl">25</span>,</span></span>
<span class="r-in"><span>                <span class="fl">5</span> ,<span class="fl">0</span> ,<span class="fl">30</span>,</span></span>
<span class="r-in"><span>                <span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">10</span>,</span></span>
<span class="r-in"><span>                <span class="fl">30</span>,<span class="fl">30</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span>                <span class="fl">15</span>,<span class="fl">30</span>,<span class="fl">10</span>,</span></span>
<span class="r-in"><span>                <span class="fl">35</span>,<span class="fl">25</span>,<span class="fl">5</span> <span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> stripe <span class="op">=</span> <span class="fu"><a href="stripe_matrix.html">stripe_matrix</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">21</span>, s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 78 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0 </span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html" class="external-link">addmargins</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       A1   A2   B1   B2        C1        C2        C3 Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A1   7.5  7.5 10.0 10.0 16.666667 16.666667 16.666667  85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A2  17.5 17.5  5.0  5.0  8.333333  8.333333  8.333333  70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B1   2.5  2.5  0.0  0.0 10.000000 10.000000 10.000000  35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B2   5.0  5.0  5.0  5.0  3.333333  3.333333  3.333333  30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C1  15.0 15.0 15.0 15.0  0.000000  0.000000  0.000000  60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C2   7.5  7.5 15.0 15.0  3.333333  3.333333  3.333333  55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C3  17.5 17.5 12.5 12.5  1.666667  1.666667  1.666667  65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sum 72.5 72.5 62.5 62.5 43.333333 43.333333 43.333333 400</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Guy J. Abel.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

