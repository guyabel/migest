<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Chord diagram for directional origin-destination data — mig_chord • migest</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Chord diagram for directional origin-destination data — mig_chord"><meta property="og:description" content="Adaption of circlize::chordDiagramFromDataFrame() with defaults set to allow for more effective visualisation of directional origin-destination data"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2XE3QBSNZJ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2XE3QBSNZJ');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">migest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/guyabel/migest/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/guyabelguyabel" class="external-link">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://guyabel.com" class="external-link">
    <span class="fas fa-blog fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Chord diagram for directional origin-destination data</h1>
    <small class="dont-index">Source: <a href="https://github.com/guyabel/migest/blob/HEAD/R/mig_chord.R" class="external-link"><code>R/mig_chord.R</code></a></small>
    <div class="hidden name"><code>mig_chord.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Adaption of <code><a href="https://rdrr.io/pkg/circlize/man/chordDiagramFromDataFrame.html" class="external-link">circlize::chordDiagramFromDataFrame()</a></code> with defaults set to allow for more effective visualisation of directional origin-destination data</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">mig_chord</span><span class="op">(</span>
  <span class="va">x</span>,
  lab <span class="op">=</span> <span class="cn">NULL</span>,
  lab_bend1 <span class="op">=</span> <span class="cn">NULL</span>,
  lab_bend2 <span class="op">=</span> <span class="cn">NULL</span>,
  label_size <span class="op">=</span> <span class="fl">1</span>,
  label_nudge <span class="op">=</span> <span class="fl">0</span>,
  label_squeeze <span class="op">=</span> <span class="fl">0</span>,
  axis_size <span class="op">=</span> <span class="fl">0.8</span>,
  axis_breaks <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>,
  no_labels <span class="op">=</span> <span class="cn">FALSE</span>,
  no_axis <span class="op">=</span> <span class="cn">FALSE</span>,
  clear_circos_par <span class="op">=</span> <span class="cn">TRUE</span>,
  zero_margin <span class="op">=</span> <span class="cn">TRUE</span>,
  start.degree <span class="op">=</span> <span class="fl">90</span>,
  gap.degree <span class="op">=</span> <span class="fl">4</span>,
  track.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,
  points.overflow.warning <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>Data frame with origin in first column, destination in second column and bilateral measure in third column</p></dd>
<dt>lab</dt>
<dd><p>Named vector of labels for plot. If <code>NULL</code> will use names from <code>d</code></p></dd>
<dt>lab_bend1</dt>
<dd><p>Named vector of bending labels for plot. Note line breaks do not work with <code>facing = "bending"</code> in circlize.</p></dd>
<dt>lab_bend2</dt>
<dd><p>Named vector of second row of bending labels for plot.</p></dd>
<dt>label_size</dt>
<dd><p>Font size of label text.</p></dd>
<dt>label_nudge</dt>
<dd><p>Numeric value to nudge labels towards (negative number) or away (positive number) the sector axis.</p></dd>
<dt>label_squeeze</dt>
<dd><p>Numeric value to nudge <code>lab_bend1</code> and <code>lab_bend2</code> labels apart (negative number) or together (positive number).</p></dd>
<dt>axis_size</dt>
<dd><p>Font size on axis labels.</p></dd>
<dt>axis_breaks</dt>
<dd><p>Numeric value for how often to add axis label breaks. Default not activated, uses default from <code><a href="https://rdrr.io/pkg/circlize/man/circos.axis.html" class="external-link">circlize::circos.axis()</a></code></p></dd>
<dt>...</dt>
<dd><p>Arguments for <code><a href="https://rdrr.io/pkg/circlize/man/chordDiagramFromDataFrame.html" class="external-link">circlize::chordDiagramFromDataFrame()</a></code>.</p></dd>
<dt>no_labels</dt>
<dd><p>Logical to indicate if to include plot labels. Set to <code>FALSE</code> by default.</p></dd>
<dt>no_axis</dt>
<dd><p>Logical to indicate if to include plot axis. Set to <code>FALSE</code> by default.</p></dd>
<dt>clear_circos_par</dt>
<dd><p>Logical to run <code><a href="https://rdrr.io/pkg/circlize/man/circos.clear.html" class="external-link">circlize::circos.clear()</a></code>. Set to <code>TRUE</code> by default. Set to <code>FALSE</code> if you wish to add further to the plot.</p></dd>
<dt>zero_margin</dt>
<dd><p>Set margins of the plotting graphics device to zero. Set to <code>TRUE</code> by default.</p></dd>
<dt>start.degree</dt>
<dd><p>Argument for <code><a href="https://rdrr.io/pkg/circlize/man/circos.par.html" class="external-link">circlize::circos.par()</a></code>.</p></dd>
<dt>gap.degree</dt>
<dd><p>Argument for <code><a href="https://rdrr.io/pkg/circlize/man/chordDiagramFromDataFrame.html" class="external-link">circlize::chordDiagramFromDataFrame()</a></code>.</p></dd>
<dt>track.margin</dt>
<dd><p>Argument for <code><a href="https://rdrr.io/pkg/circlize/man/chordDiagramFromDataFrame.html" class="external-link">circlize::chordDiagramFromDataFrame()</a></code>.</p></dd>
<dt>points.overflow.warning</dt>
<dd><p>Argument for <code><a href="https://rdrr.io/pkg/circlize/man/chordDiagramFromDataFrame.html" class="external-link">circlize::chordDiagramFromDataFrame()</a></code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Chord diagram based on first three columns of <code>x</code>. The function tweaks the defaults of <code><a href="https://rdrr.io/pkg/circlize/man/chordDiagramFromDataFrame.html" class="external-link">circlize::chordDiagramFromDataFrame()</a></code> for easier plotting of directional origin-destination data. Users can override these defaults and pass additional tweaks using any of the <code><a href="https://rdrr.io/pkg/circlize/man/chordDiagramFromDataFrame.html" class="external-link">circlize::chordDiagramFromDataFrame()</a></code> arguments.
The layout of the plots are designed to specifically work on plotting images into PDF devices with widths and heights of 7 inches (the default dimension when using the <code>pdf</code> function). See the end of the examples for converting PDF to PNG images in R. 
Fitting the sector labels on the page is usually the most time consuming task. Use the different label options, including line breaks, <code>label_nudge</code>, track height in <code>preAllocateTracks</code> and font sizes in <code>label_size</code> and <code>axis_size</code> to find the best fit. If none of the label options produce desirable results, plot your own using <code><a href="https://rdrr.io/pkg/circlize/man/circos.text.html" class="external-link">circlize::circos.text</a></code> having set <code>no_labels = TRUE</code> and <code>clear_circos_par = FALSE</code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># \dontrun{</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/countrycode/" class="external-link">countrycode</a></span><span class="op">)</span></span>
<span class="r-in"><span class="co"># download Abel and Cohen (2019) estimates</span></span>
<span class="r-in"><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"https://ndownloader.figshare.com/files/26239945"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">235236</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">9</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BB0000;">chr</span> (2): orig, dest</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">dbl</span> (7): year0, sd_drop_neg, sd_rev_neg, mig_rate, da_min_open, da_min_close...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># use dictionary to get region to region flows</span></span>
<span class="r-in"><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">f</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span class="r-in">    orig <span class="op">=</span> <span class="fu"><a href="https://vincentarelbundock.github.io/countrycode/reference/countrycode.html" class="external-link">countrycode</a></span><span class="op">(</span></span>
<span class="r-in">      sourcevar <span class="op">=</span> <span class="va">orig</span>, custom_dict <span class="op">=</span> <span class="va">dict_ims</span>,</span>
<span class="r-in">      origin <span class="op">=</span> <span class="st">"iso3c"</span>, destination <span class="op">=</span> <span class="st">"region"</span><span class="op">)</span>,</span>
<span class="r-in">    dest <span class="op">=</span> <span class="fu"><a href="https://vincentarelbundock.github.io/countrycode/reference/countrycode.html" class="external-link">countrycode</a></span><span class="op">(</span></span>
<span class="r-in">      sourcevar <span class="op">=</span> <span class="va">dest</span>, custom_dict <span class="op">=</span> <span class="va">dict_ims</span>,</span>
<span class="r-in">      origin <span class="op">=</span> <span class="st">"iso3c"</span>, destination <span class="op">=</span> <span class="st">"region"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year0</span>, <span class="va">orig</span>, <span class="va">dest</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarise_all</a></span><span class="op">(</span><span class="va">sum</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">d</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 216 × 9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    year0 orig   dest   sd_drop_neg sd_rev_neg mig_rate da_min_open da_min_closed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">1</span>990 Africa Africa     4<span style="text-decoration: underline;">297</span>155    7<span style="text-decoration: underline;">845</span>712  4<span style="text-decoration: underline;">979</span>307     6<span style="text-decoration: underline;">902</span>972       7<span style="text-decoration: underline;">429</span>916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">1</span>990 Africa Asia        <span style="text-decoration: underline;">240</span>464     <span style="text-decoration: underline;">258</span>816   <span style="text-decoration: underline;">659</span>002      <span style="text-decoration: underline;">287</span>789        <span style="text-decoration: underline;">690</span>446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">1</span>990 Africa Europe      <span style="text-decoration: underline;">554</span>285     <span style="text-decoration: underline;">662</span>901  1<span style="text-decoration: underline;">734</span>769      <span style="text-decoration: underline;">809</span>487       1<span style="text-decoration: underline;">303</span>377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">1</span>990 Africa Latin…        <span style="text-decoration: underline;">1</span>439       <span style="text-decoration: underline;">2</span>624     <span style="text-decoration: underline;">7</span>032        <span style="text-decoration: underline;">8</span>452         <span style="text-decoration: underline;">12</span>138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">1</span>990 Africa North…      <span style="text-decoration: underline;">288</span>992     <span style="text-decoration: underline;">301</span>617   <span style="text-decoration: underline;">203</span>364      <span style="text-decoration: underline;">318</span>842        <span style="text-decoration: underline;">335</span>302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">1</span>990 Africa Ocean…       <span style="text-decoration: underline;">21</span>541      <span style="text-decoration: underline;">23</span>533    <span style="text-decoration: underline;">60</span>019       <span style="text-decoration: underline;">27</span>919         <span style="text-decoration: underline;">25</span>460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">1</span>990 Asia   Africa       <span style="text-decoration: underline;">94</span>088     <span style="text-decoration: underline;">158</span>903   <span style="text-decoration: underline;">182</span>438      <span style="text-decoration: underline;">104</span>503        <span style="text-decoration: underline;">318</span>467</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">1</span>990 Asia   Asia       3<span style="text-decoration: underline;">616</span>112    8<span style="text-decoration: underline;">617</span>460 13<span style="text-decoration: underline;">154</span>071     6<span style="text-decoration: underline;">839</span>964       9<span style="text-decoration: underline;">534</span>627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>990 Asia   Europe     1<span style="text-decoration: underline;">495</span>859    2<span style="text-decoration: underline;">322</span>557  4<span style="text-decoration: underline;">987</span>315     2<span style="text-decoration: underline;">855</span>373       4<span style="text-decoration: underline;">465</span>086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">1</span>990 Asia   Latin…       <span style="text-decoration: underline;">14</span>156      <span style="text-decoration: underline;">14</span>183    <span style="text-decoration: underline;">97</span>518       <span style="text-decoration: underline;">19</span>285         <span style="text-decoration: underline;">44</span>768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 206 more rows, and 1 more variable: da_pb_closed &lt;dbl&gt;</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># 2015-2020 pseudo-Bayesian estimates for plotting</span></span>
<span class="r-in"><span class="va">pb</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year0</span> <span class="op">==</span> <span class="fl">2015</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>flow <span class="op">=</span> <span class="va">da_pb_closed</span><span class="op">/</span><span class="fl">1e6</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">orig</span>, <span class="va">dest</span>, <span class="va">flow</span><span class="op">)</span></span>
<span class="r-in"><span class="va">pb</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 36 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    orig   dest                               flow</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> Africa Africa                           8.46  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> Africa Asia                             0.984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> Africa Europe                           2.72  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> Africa Latin America and the Caribbean  0.020<span style="text-decoration: underline;">7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> Africa Northern America                 1.13  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> Africa Oceania                          0.118 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> Asia   Africa                           0.895 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> Asia   Asia                            22.4   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> Asia   Europe                           7.83  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> Asia   Latin America and the Caribbean  0.215 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 26 more rows</span></span>
<span class="r-in">    </span>
<span class="r-in"><span class="co"># pdf(file = "chord.pdf")</span></span>
<span class="r-in"><span class="fu">mig_chord</span><span class="op">(</span>x <span class="op">=</span> <span class="va">pb</span><span class="op">)</span></span>
<span class="r-plt img"><img src="mig_chord-1.png" alt="" width="700" height="700"></span>
<span class="r-in"><span class="co"># dev.off()</span></span>
<span class="r-in"><span class="co"># file.show("chord.pdf")</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># pass arguments to circlize::chordDiagramFromDataFrame</span></span>
<span class="r-in"><span class="co"># pdf(file = "chord.pdf")</span></span>
<span class="r-in"><span class="fu">mig_chord</span><span class="op">(</span>x <span class="op">=</span> <span class="va">pb</span>, </span>
<span class="r-in">          <span class="co"># order of regions</span></span>
<span class="r-in">          order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">pb</span><span class="op">$</span><span class="va">orig</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">          <span class="co"># spacing for labels</span></span>
<span class="r-in">          preAllocateTracks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>track.height <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>,</span>
<span class="r-in">          <span class="co"># colours</span></span>
<span class="r-in">          grid.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"royalblue"</span>, <span class="st">"navyblue"</span>, <span class="st">"skyblue"</span>, <span class="st">"cadetblue"</span>, <span class="st">"darkblue"</span><span class="op">)</span></span>
<span class="r-in">          <span class="op">)</span> </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Since you have set `order`, you should better set `grid.col` as a named</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> vector where sector names are the vector names, or else the color will</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> be wrongly assigned.</span>
<span class="r-plt img"><img src="mig_chord-2.png" alt="" width="700" height="700"></span>
<span class="r-in"><span class="co"># dev.off()</span></span>
<span class="r-in"><span class="co"># file.show("chord.pdf")</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># multiple line labels to fit on longer labels</span></span>
<span class="r-in"><span class="va">r</span> <span class="op">&lt;-</span> <span class="va">pb</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="sum_region.html">sum_region</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lab <span class="op">=</span> <span class="fu"><a href="str_wrap_n.html">str_wrap_n</a></span><span class="op">(</span>string <span class="op">=</span> <span class="va">region</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">lab</span>, into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lab1"</span>, <span class="st">"lab2"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"\n"</span>, remove <span class="op">=</span> <span class="cn">FALSE</span>, fill <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Asking for more lines than words</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Asking for more lines than words</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Asking for more lines than words</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Asking for more lines than words</span>
<span class="r-in"><span class="va">r</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   region                          out_mig in_mig  turn    net lab    lab1  lab2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Africa                             4.97   2.65  7.62 -<span style="color: #BB0000;">2.32</span>  <span style="color: #949494;">"</span>Afri… Afri… <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Asia                              15.8    7.17 23.0  -<span style="color: #BB0000;">8.65</span>  <span style="color: #949494;">"</span>Asia<span style="color: #949494;">"</span> Asia  <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> Europe                             7.66  14.5  22.1   6.80  <span style="color: #949494;">"</span>Euro… Euro… <span style="color: #BB0000;">NA</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> Latin America and the Caribbean    6.70   4.09 10.8  -<span style="color: #BB0000;">2.61</span>  <span style="color: #949494;">"</span>Lati… Lati… and …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> Northern America                   7.17  13.2  20.3   5.98  <span style="color: #949494;">"</span>Nort… Nort… Amer…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> Oceania                            1.33   2.12  3.45  0.793 <span style="color: #949494;">"</span>Ocea… Ocea… <span style="color: #BB0000;">NA</span>   </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># pdf(file = "chord.pdf")</span></span>
<span class="r-in"><span class="fu">mig_chord</span><span class="op">(</span>x <span class="op">=</span> <span class="va">pb</span>,</span>
<span class="r-in">          lab <span class="op">=</span> <span class="va">r</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">lab</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">            <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">deframe</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span class="r-in">          preAllocateTracks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>track.height <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span>
<span class="r-in">          label_size <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span class="r-in">          axis_size <span class="op">=</span> <span class="fl">0.7</span></span>
<span class="r-in">          <span class="op">)</span></span>
<span class="r-plt img"><img src="mig_chord-3.png" alt="" width="700" height="700"></span>
<span class="r-in"><span class="co"># dev.off()</span></span>
<span class="r-in"><span class="co"># file.show("chord.pdf")</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># bending labels</span></span>
<span class="r-in"><span class="co"># pdf(file = "chord.pdf")</span></span>
<span class="r-in"><span class="fu">mig_chord</span><span class="op">(</span>x <span class="op">=</span> <span class="va">pb</span>,</span>
<span class="r-in">          lab_bend1 <span class="op">=</span> <span class="va">r</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">lab1</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">            <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">deframe</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span class="r-in">          lab_bend2 <span class="op">=</span> <span class="va">r</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">lab2</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">            <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">deframe</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in">          <span class="op">)</span></span>
<span class="r-plt img"><img src="mig_chord-4.png" alt="" width="700" height="700"></span>
<span class="r-in"><span class="co"># dev.off()</span></span>
<span class="r-in"><span class="co"># file.show("chord.pdf")</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># convert pdf to image file</span></span>
<span class="r-in"><span class="co"># library(magick)</span></span>
<span class="r-in"><span class="co"># p &lt;- image_read_pdf("chord.pdf")</span></span>
<span class="r-in"><span class="co"># image_write(image = p, path = "chord.png")</span></span>
<span class="r-in"><span class="co"># file.show("chord.png")</span></span>
<span class="r-in"><span class="co"># }</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Guy J. Abel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

