<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Iterative proportional fitting routine for the indirect estimation of origin-destination-migrant type migration flow tables with known origin and destination margins. — ipf3 • migest</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Iterative proportional fitting routine for the indirect estimation of origin-destination-migrant type migration flow tables with known origin and destination margins. — ipf3"><meta property="og:description" content="The ipf3 function finds the maximum likelihood estimates for fitted values in the log-linear model:
$$ \log y_{ijk} = \log \alpha_{i} + \log \beta_{j} + \log \lambda_{k} + \log \gamma_{ik} + \log \kappa_{jk} + \log m_{ijk} $$
where \(m_{ijk}\) is a set of prior estimates for \(y_{ijk}\) and is no more complex than the matrices being fitted."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2XE3QBSNZJ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2XE3QBSNZJ');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">migest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/guyabel/migest/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/guyabelguyabel" class="external-link">
    <span class="fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://guyabel.com" class="external-link">
    <span class="fas fa-blog fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Iterative proportional fitting routine for the indirect estimation of origin-destination-migrant type migration flow tables with known origin and destination margins.</h1>
    <small class="dont-index">Source: <a href="https://github.com/guyabel/migest/blob/HEAD/R/ipf3.R" class="external-link"><code>R/ipf3.R</code></a></small>
    <div class="hidden name"><code>ipf3.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>ipf3</code> function finds the maximum likelihood estimates for fitted values in the log-linear model:
$$ \log y_{ijk} = \log \alpha_{i} + \log \beta_{j} + \log \lambda_{k} + \log \gamma_{ik} + \log \kappa_{jk} + \log m_{ijk} $$
where \(m_{ijk}\) is a set of prior estimates for \(y_{ijk}\) and is no more complex than the matrices being fitted.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ipf3</span><span class="op">(</span></span>
<span>  row_tot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  col_tot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  m <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>row_tot</dt>
<dd><p>Vector of origin totals to constrain the sum of the imputed cell rows.</p></dd>


<dt>col_tot</dt>
<dd><p>Vector of destination totals to constrain the sum of the imputed cell columns.</p></dd>


<dt>m</dt>
<dd><p>Array of auxiliary data. By default set to 1 for all origin-destination-migrant typologies combinations.</p></dd>


<dt>tol</dt>
<dd><p>Numeric value for the tolerance level used in the parameter estimation.</p></dd>


<dt>maxit</dt>
<dd><p>Numeric value for the maximum number of iterations used in the parameter estimation.</p></dd>


<dt>verbose</dt>
<dd><p>Logical value to indicate the print the parameter estimates at each iteration. By default <code>FALSE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Iterative Proportional Fitting routine set up in a similar manner to Agresti (2002, p.343). The arguments <code>row_tot</code> and <code>col_tot</code> take the row-table and column-table specific known margins.</p>


<p>The user must ensure that the row and column totals in each table sum to the same value. Care must also be taken to allow the dimension of the auxiliary matrix (<code>m</code>) to equal those provided in the row and column totals.</p>


<p>Returns a <code>list</code> object with</p>
<dl><dt>mu </dt>
<dd><p>Array of indirect estimates of origin-destination matrices by migrant characteristic</p></dd>

<dt>it </dt>
<dd><p>Iteration count</p></dd>

<dt>tol </dt>
<dd><p>Tolerance level at final iteration</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Abel and Cohen (2019) Bilateral international migration flow estimates for 200 countries <em>Scientific Data</em> 6 (1), 1-13</p>
<p>Azose &amp; Raftery (2019) Estimation of emigration, return migration, and transit migration between all pairs of countries <em>Proceedings of the National Academy of Sciences</em> 116 (1) 116-122</p>
<p>Abel, G. J. (2013). Estimating Global Migration Flow Tables Using Place of Birth. <em>Demographic Research</em> 28, (18) 505-546</p>
<p>Agresti, A. (2002). <em>Categorical Data Analysis</em> 2nd edition. Wiley.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ipf3_qi.html">ipf3_qi</a></code>, <code><a href="ipf2.html">ipf2</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Guy J. Abel</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## create row-table and column-table specific known margins.</span></span></span>
<span class="r-in"><span><span class="va">dn</span> <span class="op">&lt;-</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">P1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">100</span>,  <span class="fl">10</span>,   <span class="fl">0</span>, </span></span>
<span class="r-in"><span>               <span class="fl">55</span>,   <span class="fl">555</span>,  <span class="fl">50</span>,   <span class="fl">5</span>, </span></span>
<span class="r-in"><span>               <span class="fl">80</span>,    <span class="fl">40</span>, <span class="fl">800</span> , <span class="fl">40</span>, </span></span>
<span class="r-in"><span>               <span class="fl">20</span>,    <span class="fl">25</span>,  <span class="fl">20</span>, <span class="fl">200</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>             dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pob <span class="op">=</span> <span class="va">dn</span>, por <span class="op">=</span> <span class="va">dn</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">P2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">950</span>, <span class="fl">100</span>,  <span class="fl">60</span>,   <span class="fl">0</span>, </span></span>
<span class="r-in"><span>                <span class="fl">80</span>, <span class="fl">505</span>,  <span class="fl">75</span>,   <span class="fl">5</span>, </span></span>
<span class="r-in"><span>                <span class="fl">90</span>,  <span class="fl">30</span>, <span class="fl">800</span>,  <span class="fl">40</span>, </span></span>
<span class="r-in"><span>                <span class="fl">40</span>,  <span class="fl">45</span>,   <span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, </span></span>
<span class="r-in"><span>             dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pob <span class="op">=</span> <span class="va">dn</span>, por <span class="op">=</span> <span class="va">dn</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># display with row and col totals</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html" class="external-link">addmargins</a></span><span class="op">(</span><span class="va">P1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      por</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pob      A   B   C   D  Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A   1000 100  10   0 1110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B     55 555  50   5  665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C     80  40 800  40  960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D     20  25  20 200  265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sum 1155 720 880 245 3000</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html" class="external-link">addmargins</a></span><span class="op">(</span><span class="va">P2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      por</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pob      A   B   C   D  Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A    950 100  60   0 1110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B     80 505  75   5  665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C     90  30 800  40  960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D     40  45   0 180  265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sum 1160 680 935 225 3000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># run ipf</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">ipf3</span><span class="op">(</span>row_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">P1</span><span class="op">)</span>, col_tot <span class="op">=</span> <span class="va">P2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 996 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1.136868e-13 </span>
<span class="r-in"><span><span class="co"># display with row, col and table totals</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html" class="external-link">addmargins</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , pob = A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      dest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orig      A     B    C D  Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A   855.9  90.1 54.1 0 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B    85.6   9.0  5.4 0  100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C     8.6   0.9  0.5 0   10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D     0.0   0.0  0.0 0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sum 950.0 100.0 60.0 0 1110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , pob = B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      dest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orig     A     B    C   D Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A    6.6  41.8  6.2 0.4  55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B   66.8 421.5 62.6 4.2 555</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C    6.0  38.0  5.6 0.4  50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D    0.6   3.8  0.6 0.0   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sum 80.0 505.0 75.0 5.0 665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , pob = C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      dest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orig     A    B     C    D Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A    7.5  2.5  66.7  3.3  80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B    3.8  1.3  33.3  1.7  40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C   75.0 25.0 666.7 33.3 800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D    3.8  1.3  33.3  1.7  40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sum 90.0 30.0 800.0 40.0 960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , pob = D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      dest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orig     A    B C     D Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A    3.0  3.4 0  13.6  20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B    3.8  4.2 0  17.0  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C    3.0  3.4 0  13.6  20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D   30.2 34.0 0 135.8 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sum 40.0 45.0 0 180.0 265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , pob = Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      dest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orig       A     B     C     D  Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A    873.0 137.8 126.9  17.3 1155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B    159.9 436.0 101.3  22.8  720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C     92.6  67.3 672.8  47.3  880</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D     34.5  39.0  33.9 137.6  245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sum 1160.0 680.0 935.0 225.0 3000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># origin-destination flow table</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="sum_od.html">sum_od</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      dest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orig      A     B     C    D   Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A     0.0 137.8 126.9 17.3 282.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B   159.9   0.0 101.3 22.8 284.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C    92.6  67.3   0.0 47.3 207.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D    34.5  39.0  33.9  0.0 107.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sum 287.0 244.0 262.2 87.4 880.6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## with alternative offset term</span></span></span>
<span class="r-in"><span><span class="va">dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">7</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">ipf3</span><span class="op">(</span>row_tot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">P1</span><span class="op">)</span>, col_tot <span class="op">=</span> <span class="va">P2</span>, m <span class="op">=</span> <span class="va">dis</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 990 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 267.9774 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 13.70557 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 1.609235 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.176649 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.01924174 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 0.002094159 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 0.000227895 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 2.480023e-05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2.698833e-06 </span>
<span class="r-in"><span><span class="co"># display with row, col and table totals</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/addmargins.html" class="external-link">addmargins</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , pob = A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      dest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orig      A     B    C D  Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A   847.7  96.5 55.8 0 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B    93.3   2.7  4.1 0  100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C     9.1   0.9  0.1 0   10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D     0.0   0.0  0.0 0    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sum 950.0 100.0 60.0 0 1110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , pob = B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      dest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orig     A     B    C   D Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A    2.3  49.3  3.2 0.2  55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B   74.8 404.4 71.1 4.7 555</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C    2.6  46.9  0.4 0.1  50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D    0.3   4.5  0.2 0.0   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sum 80.0 505.0 75.0 5.0 665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , pob = C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      dest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orig     A    B     C    D Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A    1.2  0.5  77.5  0.9  80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B    0.9  0.1  38.6  0.5  40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C   87.0 29.1 645.3 38.6 800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D    1.0  0.3  38.7  0.0  40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sum 90.0 30.0 800.0 40.0 960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , pob = D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      dest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orig     A    B C     D Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A    0.4  0.6 0  19.0  20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B    0.7  0.2 0  24.1  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C    0.6  0.8 0  18.5  20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D   38.3 43.4 0 118.3 200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sum 40.0 45.0 0 180.0 265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , pob = Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      dest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orig       A     B     C     D  Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A    851.5 146.8 136.6  20.1 1155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B    169.6 407.4 113.8  29.3  720</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C     99.3  77.7 645.8  57.3  880</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D     39.6  48.2  38.9 118.4  245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sum 1160.0 680.0 935.0 225.0 3000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># origin-destination flow table</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="sum_od.html">sum_od</a></span><span class="op">(</span><span class="va">y</span><span class="op">$</span><span class="va">mu</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      dest</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> orig      A     B     C     D   Sum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A     0.0 146.8 136.6  20.1 303.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B   169.6   0.0 113.8  29.3 312.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C    99.3  77.7   0.0  57.3 234.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D    39.6  48.2  38.9   0.0 126.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sum 308.5 272.6 289.2 106.6 977.0</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Guy J. Abel.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

